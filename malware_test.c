#include <stdio.h>
#include <string.h>
#include <stdlib.h>

// Test file with suspicious patterns for YARA detection

void suspicious_function() {
    // API calls that might be flagged
    void* mem = VirtualAlloc(NULL, 1024, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    WriteProcessMemory(GetCurrentProcess(), mem, "shellcode", 9, NULL);
    CreateRemoteThread(GetCurrentProcess(), NULL, 0, (LPTHREAD_START_ROUTINE)mem, NULL, 0, NULL);
    
    // Network indicators
    const char* url = "http://malicious-server.com/payload";
    const char* bitcoin_addr = "1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa";
    
    // Crypto operations
    const char* aes_key = "AES-256-CBC";
    const char* base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    
    // Socket operations
    socket(AF_INET, SOCK_STREAM, 0);
    connect(0, NULL, 0);
    send(0, "data", 4, 0);
    recv(0, NULL, 0, 0);
}

int main() {
    printf("This is a test file for threat detection\n");
    suspicious_function();
    return 0;
}